<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mood-to-Music Generator</title>
  <style>
    :root { --bg:#b7e3ff; --bubble-shadow:rgba(0,0,0,0.08); --calm:#84d8ff; --sad:#8da1ff; --happy:#ffd166; --angry:#ff8fab; --dreamy:#caa8ff; }
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;background:radial-gradient(1200px 800px at 70% 20%,#c8edff 0%,var(--bg) 60%,#9fd7ff 100%);display:flex;flex-direction:column;align-items:center;justify-content:flex-start;overflow:hidden;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"}
    h1{margin:40px 12px 10px;text-align:center;font-weight:800;letter-spacing:.5px;color:#0d2a42;text-shadow:0 2px 0 rgba(255,255,255,.6)}
    .sky{position:relative;width:100%;height:calc(100vh - 100px);overflow:hidden}
    .bubble{position:absolute;display:inline-flex;align-items:center;justify-content:center;padding:22px 36px;min-width:160px;min-height:90px;border-radius:50px;box-shadow:0 8px 18px var(--bubble-shadow),inset 0 -4px 10px rgba(255,255,255,.6);color:#0d2a42;filter:saturate(1.05);animation:floatY 12s ease-in-out infinite,driftX 30s linear infinite;cursor:pointer;outline:0}
    .bubble.disabled{pointer-events:none;opacity:.5}
    .bubble:focus-visible{box-shadow:0 0 0 4px rgba(255,255,255,.8),0 8px 18px var(--bubble-shadow),inset 0 -4px 10px rgba(255,255,255,.6)}
    .bubble::before,.bubble::after{content:"";position:absolute;background:inherit;border-radius:50%;box-shadow:inherit}
    .bubble::before{width:55%;height:55%;left:-18%;bottom:4%}
    .bubble::after{width:40%;height:40%;right:-14%;top:0%}
    .inner{display:inline-block;font-size:2rem;transition:transform 160ms ease,filter 160ms ease;will-change:transform}
    .bubble:hover .inner{transform:scale(1.06);filter:brightness(1.05)}
    .bubble.clicked .inner{animation:pop 240ms ease}
    @keyframes pop{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}
    .calm{background:linear-gradient(180deg,var(--calm),#c8f1ff)}
    .sad{background:linear-gradient(180deg,var(--sad),#d5ddff)}
    .happy{background:linear-gradient(180deg,var(--happy),#ffe7a3)}
    .angry{background:linear-gradient(180deg,var(--angry),#ffd1da)}
    .dreamy{background:linear-gradient(180deg,var(--dreamy),#ecd8ff)}
    .calm{top:20%;left:8%;animation-delay:0s,-2s}
    .sad{top:45%;left:22%;animation-delay:.8s,-10s}
    .happy{top:15%;left:50%;transform:translateX(-50%);animation-delay:1.6s,-18s}
    .angry{top:55%;right:8%;animation-delay:2.2s,-6s}
    .dreamy{top:70%;left:55%;animation-delay:3s,-14s}
    @keyframes floatY{0%{transform:translateY(0)}50%{transform:translateY(-18px)}100%{transform:translateY(0)}}
    @keyframes driftX{0%{transform:translateX(0)}50%{transform:translateX(16px)}100%{transform:translateX(0)}}
    @media (max-width:720px){h1{font-size:1.4rem}.bubble{min-width:140px;min-height:80px;padding:18px 28px}.inner{font-size:1.5rem}}
  </style>
</head>
<body>
  <h1>Mood-to-Music Generator</h1>
  <div class="sky">
    <div class="bubble sad" role="button" tabindex="0"><span class="inner">üò¢</span></div>
    <div class="bubble calm" role="button" tabindex="0"><span class="inner">üòå</span></div>
    <div class="bubble happy" role="button" tabindex="0"><span class="inner">üòä</span></div>
    <div class="bubble angry" role="button" tabindex="0"><span class="inner">üò†</span></div>
    <div class="bubble dreamy" role="button" tabindex="0"><span class="inner">‚òÅÔ∏è</span></div>
  </div>

  <script>
    const audio = new Audio();
    audio.preload = "auto";
    const files = { 
      sad: "static/sad.wav", 
      calm: "static/calm.wav",  
      happy: "static/happy.wav", 
      angry: "static/angry.wav", 
      dreamy: "static/dreamy.wav" 
    };
    let busy = false;

    function moodFromEl(el){ return Object.keys(files).find(m => el.classList.contains(m)); }
    function disableAll(state){ document.querySelectorAll(".bubble").forEach(b => b.classList.toggle("disabled", state)); }
    function clickAnim(el){ el.classList.add("clicked"); setTimeout(()=>el.classList.remove("clicked"),260); }

    async function trigger(el){
      if(busy) return;
      const mood = moodFromEl(el); if(!mood) return;
      busy = true; disableAll(true); clickAnim(el);
      try{
        audio.src = files[mood];
        await audio.play().catch(()=>{});
      } finally {
        audio.onended = ()=>{ busy=false; disableAll(false); };
        setTimeout(()=>{ if(audio.paused){ busy=false; disableAll(false); } }, 1000);
      }
    }

    document.querySelectorAll(".bubble").forEach(b=>{
      b.addEventListener("click", ()=>trigger(b));
      b.addEventListener("keydown", e=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); trigger(b); }});
    });
  </script>
</body>
</html>